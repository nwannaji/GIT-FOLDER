{% extends 'base.html' %}
{% load static %}


{% block content %}

<h3 class="text-primary font-effect-3d-float" style="text-align: center;">Visitors List</h3>

<!-- DASHBOARD -->
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12 mb-lg-0 mb4">
            <div class="card h-100 p-3">
                <div class="card-body p-3 rounded-top rounded-bottom">
                    <div class="d-flex flex-column h-100">
                        <p class="mb-1 pt-2 fw-bold text-white"><i class="fas fa-users">Visitors</i></p>
                        <table id="table-section" class="table table-responsive table-hover">
                         <thead class="text-primary">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">VISITOR NAME</th>
                                <th scope="col">ORGANIZATION</th>
                                <th scope="col">HOST EMPLOYEE</th>
                                <th scope="col">HOST DEPT</th>
                                <!-- <th scope="col">OFFICIAL?</th>
                                <th scope="col">INVITED?</th>
                                <th scope="col">FIRST TIME?</th> -->
                                <th scope="col">APPOINTMENT DATE</th>
                            </tr>
                         </thead>
                         <tbody class="text-primary">
                            {% for visitor in visitor_data_list %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ visitor.visitor_name }}</td>
                                    <td>{{ visitor.organization }}</td>
                                    <td>{{ visitor.employee_names }}</td>
                                    <td>{{ visitor.dept_names }}</td>
                                    <td>{{ visitor.date_of_visit}}</td>
                                </tr>
                                {% endfor %}
                         </tbody>
                        </table>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END DASHBOARD -->
<!-- CREATE VISITOR MODAL -->
<div class="modal fade" id="visitorModal" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title fs-5 text-primary"id="modal-title">Visitor's Detail</div>
                    {% if messages %}
                        <ul>
                            {% for message in messages %}
                                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="{% url 'schedule_visit' %}" method="post">
                    {% csrf_token %}
                    <div class="row g-3 needs-validation" novalidate>
                      <div class="col-md-6">
                        <label for="visitor_name" class="form-label text-primary">Visitor's Name</label>
                        <input type="text" id="visitor_name" name="visitor_name" class="form-control border-primary" required>
                      </div>
                      <div class="col-md-6">
                            <label for="phone_number" class="form-label text-primary">(Int'l) Phonenumber</label>
                            <input type="text" id="phone_number" name="phone_number" class="form-control border-primary" required>
                        </div>
                        <div class="col-md-6">
                            <label for="email_address" class="form-label text-primary">Email Address</label>
                            <input type="text" id="email_address" name="email_address" class="form-control border-primary" required>
                        </div>
                        <div class="col-md-6">
                            <label for="organization" class="form-label text-primary">organization</label>
                            <input type="text" id="organization" name="organization" class="form-control border-primary" required>
                        </div>
                        <div class="col-md-6">
                            <label for="dept" class="form-label text-primary"> Host Department</label>
                            <select id="dept" name="dept" class="form-select border-primary" required>
                                <option value="" selected disabled>Select Department</option>
                                <option value="MDs Office">MDs Office</option>
                                <option value="Human Resource">Human Resource</option>
                                <option value="Finance & Admin">Finance & Admin</option>
                                <option value="Accounts">Accounts</option>
                                <option value="Registry">Registry</option>
                                <option value="Budget">Budget</option>
                                <option value="Satellite Control Center">Satellite Control Center</option>
                                <option value="Network Operating Center">Network Operating Center</option>
                                <option value="Broad Band Services">Broad Band Services</option>
                                <option value="Innovation">Innovation</option>
                                <option value="Navigation">Navigation</option>
                                <option value="Procurement">Procurement</option>
                                <option value="Legal">Legal</option>
                                <option value="Facility">Facility</option>
                                <option value="ISSD">ISSD</option>
                                <option value="IT">IT</option>    
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="whom_to_see" class="form-label text-primary">Host Employee</label>
                            <input type="text" id="whom_to_see" name="whom_to_see" class="form-control border-primary" required>
                        </div>
                        <div class="col-md-6">
                            <label for="is_official" class="form-label text-primary">Purpose of Visit</label>
                            <input type="text" id="comments" name="comments" class="form-control border-primary" required>
                        </div>
                        <div class="col-md-6">
                            <label for="date_of_visit" class="form-label text-primary">Date of Visit</label>
                            <input type="date" id="date_of_visit" name="date_of_visit" class="form-control border-primary" required>
                        </div> 
                        <div class="col-md-3 form-group">
                            <label for="is_invited" class="form-label text-primary">Is_Official?</label>
                            <input type="checkbox" id="is_official" name="is_official">
                        </div>                        
                        <div class="col-md-3 form-group">
                            <label for="is_invited" class="form-label text-primary">Expected?</label>
                            <input type="checkbox" id="is_invited" name="is_invited">
                        </div>
                        <div class="col-md-3 form-group">
                            <label for="first_timer" class="form-label text-primary">First Timer?</label>
                            <input type="checkbox" id="first_timer" name="first_timer">
                          </div>       
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
            <!-- This JavaScript code ensure that a checkBox is checked at s time and not the two simutaeously -->
            <script>
                const invitedCheckbox = document.getElementById('is_invited');
                const firstTimerCheckbox = document.getElementById('first_timer');
                const isOfficialCheckbox = document.getElementById('is_official');
            
                invitedCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        firstTimerCheckbox.checked = false;
                    }
                });
            
                firstTimerCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        invitedCheckbox.checked = false;
                    }
                });
                isOfficialCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        isOfficialCheckbox.checked = true;
                    }
                });
            </script>
        </div>
    </div>
</div>

<!-- END VISITOR MODAL -->
{% endblock %}
